{"paragraphs":[{"text":"%pyspark   \n\n# 거래 정보 파일 읽기 -> 한 행씩 읽어서 컬렉션(RDD)에 저장\ntransactions = sc.textFile('data-files/transactions.txt')   #하둡파일 시스템에서 읽어온다.","user":"anonymous","dateUpdated":"2020-10-26T10:21:48+0900","config":{"colWidth":12,"fontSize":13,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1603433924883_1838891478","id":"20201023-151844_756974652","dateCreated":"2020-10-23T15:18:44+0900","dateStarted":"2020-10-26T10:21:48+0900","dateFinished":"2020-10-26T10:21:48+0900","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:692"},{"text":"%pyspark\n\n#전체 (collect) 또는 일부(take)를 가져오기\ntransactions.take(5)\n# transactions.collect()","user":"anonymous","dateUpdated":"2020-10-26T10:21:48+0900","config":{"colWidth":12,"fontSize":13,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['2015-03-30#6:55 AM#51#68#1#9506.21', '2015-03-30#7:39 PM#99#86#5#4107.59', '2015-03-30#11:57 AM#79#58#7#2987.22', '2015-03-30#12:46 AM#51#50#6#7501.89', '2015-03-30#11:39 AM#86#24#5#8370.2']\n"}]},"apps":[],"jobName":"paragraph_1603434152525_-2101339439","id":"20201023-152232_877225381","dateCreated":"2020-10-23T15:22:32+0900","dateStarted":"2020-10-26T10:21:48+0900","dateFinished":"2020-10-26T10:21:48+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:693"},{"text":"%pyspark\n\n# 각 행의 문자열을 '#'을 기준으로 분할해서 LIST로 반환 (문자열 -> list) \ntransactions2 = transactions.map( lambda line: line.split('#') )\n\n# 각 행 리스트를 (고객번호, 행리스트) 튜플로 변환\ntransactions3 = transactions2.map( lambda tran: (int(tran[2]), tran) )    #문자열을 숫자로 변경 int(tran[2])","user":"anonymous","dateUpdated":"2020-10-26T10:21:48+0900","config":{"colWidth":12,"fontSize":11,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1603434405104_-90952214","id":"20201023-152645_1587279179","dateCreated":"2020-10-23T15:26:45+0900","dateStarted":"2020-10-26T10:21:48+0900","dateFinished":"2020-10-26T10:21:48+0900","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:694"},{"text":"%pyspark\n\ntransactions3.take(5)   ","user":"anonymous","dateUpdated":"2020-10-26T10:21:48+0900","config":{"colWidth":12,"fontSize":11,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(51, ['2015-03-30', '6:55 AM', '51', '68', '1', '9506.21']), (99, ['2015-03-30', '7:39 PM', '99', '86', '5', '4107.59']), (79, ['2015-03-30', '11:57 AM', '79', '58', '7', '2987.22']), (51, ['2015-03-30', '12:46 AM', '51', '50', '6', '7501.89']), (86, ['2015-03-30', '11:39 AM', '86', '24', '5', '8370.2'])]\n"}]},"apps":[],"jobName":"paragraph_1603434914609_699796927","id":"20201023-153514_1286140652","dateCreated":"2020-10-23T15:35:14+0900","dateStarted":"2020-10-26T10:21:48+0900","dateFinished":"2020-10-26T10:21:49+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:695"},{"text":"%pyspark\n\n## 최다 구매 고객에게 곰인형 사은품 증정  (주문 건수 확인!)","user":"anonymous","dateUpdated":"2020-10-26T10:21:49+0900","config":{"colWidth":12,"fontSize":15,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1603436785125_612621970","id":"20201023-160625_714831946","dateCreated":"2020-10-23T16:06:25+0900","dateStarted":"2020-10-26T10:21:49+0900","dateFinished":"2020-10-26T10:21:49+0900","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:696"},{"text":"%pyspark\n\n# 전체 고객수 출력\n# transactions3.keys().take(10)\n# transactions3.keys().distinct().take(10)\ntransactions3.keys().distinct().count()","user":"anonymous","dateUpdated":"2020-10-26T10:21:49+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"100\n"}]},"apps":[],"jobName":"paragraph_1603436784373_-1287720601","id":"20201023-160624_1327374404","dateCreated":"2020-10-23T16:06:24+0900","dateStarted":"2020-10-26T10:21:49+0900","dateFinished":"2020-10-26T10:21:50+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:697"},{"text":"%pyspark\n\n#고객별 주문 건수 조회\n\n# transactions3.countByKey()\ntransactions3.countByKey().items()","user":"anonymous","dateUpdated":"2020-10-26T10:21:50+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"dict_items([(51, 18), (99, 12), (79, 13), (86, 9), (63, 12), (23, 13), (49, 8), (97, 12), (94, 12), (91, 13), (20, 8), (38, 9), (46, 9), (56, 17), (11, 8), (59, 9), (8, 10), (85, 9), (27, 7), (84, 9), (54, 7), (74, 11), (6, 7), (35, 10), (39, 11), (47, 13), (17, 13), (40, 10), (57, 8), (80, 7), (87, 10), (52, 9), (30, 5), (62, 6), (41, 12), (71, 10), (61, 8), (95, 8), (5, 11), (2, 15), (78, 11), (13, 12), (4, 11), (100, 12), (19, 6), (98, 11), (53, 19), (89, 9), (15, 10), (45, 11), (12, 7), (32, 14), (16, 8), (1, 9), (72, 7), (14, 8), (7, 10), (28, 11), (43, 12), (93, 12), (70, 8), (73, 7), (65, 10), (50, 14), (3, 13), (69, 7), (60, 4), (76, 15), (66, 11), (90, 8), (10, 7), (34, 14), (83, 12), (64, 10), (18, 9), (81, 9), (44, 8), (21, 13), (88, 5), (58, 13), (24, 9), (26, 11), (77, 11), (36, 5), (22, 10), (31, 14), (96, 8), (29, 9), (33, 9), (68, 12), (75, 10), (25, 12), (48, 5), (82, 13), (9, 7), (67, 5), (37, 7), (55, 13), (92, 8), (42, 7)])\n"}]},"apps":[],"jobName":"paragraph_1603436783549_1419840127","id":"20201023-160623_164906254","dateCreated":"2020-10-23T16:06:23+0900","dateStarted":"2020-10-26T10:21:50+0900","dateFinished":"2020-10-26T10:21:50+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:698"},{"text":"%pyspark\n\n# 총 거래 건수 조회 \nprint(sum(transactions3.countByKey().values()))\nprint(transactions.count())","user":"anonymous","dateUpdated":"2020-10-26T10:21:50+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"1000\n1000\n"}]},"apps":[],"jobName":"paragraph_1603436782237_2077532380","id":"20201023-160622_652656466","dateCreated":"2020-10-23T16:06:22+0900","dateStarted":"2020-10-26T10:21:50+0900","dateFinished":"2020-10-26T10:21:52+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:699"},{"text":"%pyspark\n\n# RDD에 들어있는 데이터를 파이썬리스트로 변환\ntransactions4 = [ (key, value) for key, value in transactions3.countByKey().items() ]","user":"anonymous","dateUpdated":"2020-10-26T10:21:53+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1603436780876_933341507","id":"20201023-160620_1625742259","dateCreated":"2020-10-23T16:06:20+0900","dateStarted":"2020-10-26T10:21:53+0900","dateFinished":"2020-10-26T10:21:54+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:700"},{"text":"%pyspark\n\ntransactions4","user":"anonymous","dateUpdated":"2020-10-26T10:21:54+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(51, 18), (99, 12), (79, 13), (86, 9), (63, 12), (23, 13), (49, 8), (97, 12), (94, 12), (91, 13), (20, 8), (38, 9), (46, 9), (56, 17), (11, 8), (59, 9), (8, 10), (85, 9), (27, 7), (84, 9), (54, 7), (74, 11), (6, 7), (35, 10), (39, 11), (47, 13), (17, 13), (40, 10), (57, 8), (80, 7), (87, 10), (52, 9), (30, 5), (62, 6), (41, 12), (71, 10), (61, 8), (95, 8), (5, 11), (2, 15), (78, 11), (13, 12), (4, 11), (100, 12), (19, 6), (98, 11), (53, 19), (89, 9), (15, 10), (45, 11), (12, 7), (32, 14), (16, 8), (1, 9), (72, 7), (14, 8), (7, 10), (28, 11), (43, 12), (93, 12), (70, 8), (73, 7), (65, 10), (50, 14), (3, 13), (69, 7), (60, 4), (76, 15), (66, 11), (90, 8), (10, 7), (34, 14), (83, 12), (64, 10), (18, 9), (81, 9), (44, 8), (21, 13), (88, 5), (58, 13), (24, 9), (26, 11), (77, 11), (36, 5), (22, 10), (31, 14), (96, 8), (29, 9), (33, 9), (68, 12), (75, 10), (25, 12), (48, 5), (82, 13), (9, 7), (67, 5), (37, 7), (55, 13), (92, 8), (42, 7)]\n"}]},"apps":[],"jobName":"paragraph_1603434912556_571510376","id":"20201023-153512_1516630451","dateCreated":"2020-10-23T15:35:12+0900","dateStarted":"2020-10-26T10:21:54+0900","dateFinished":"2020-10-26T10:21:54+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:701"},{"text":"%pyspark\n\n# 주문 건수를 기준으로 내림차순 정렬\ntransactions4.sort(key = lambda x: -x[1])    #-를 주면 역순정렬\ntransactions4[:5]","user":"anonymous","dateUpdated":"2020-10-26T10:21:54+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(53, 19), (51, 18), (56, 17), (2, 15), (76, 15)]\n"}]},"apps":[],"jobName":"paragraph_1603438526794_-978300551","id":"20201023-163526_1716335307","dateCreated":"2020-10-23T16:35:26+0900","dateStarted":"2020-10-26T10:21:54+0900","dateFinished":"2020-10-26T10:21:54+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:702"},{"text":"%pyspark\n\n#최다 구매 고객 조회\ncid, purchase = transactions4[0]\ncid, purchase","user":"anonymous","dateUpdated":"2020-10-26T10:21:54+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"(53, 19)\n"}]},"apps":[],"jobName":"paragraph_1603438526634_-1813246657","id":"20201023-163526_576564707","dateCreated":"2020-10-23T16:35:26+0900","dateStarted":"2020-10-26T10:21:54+0900","dateFinished":"2020-10-26T10:21:54+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:703"},{"text":"%pyspark\n\ntransactions3.take(5)","user":"anonymous","dateUpdated":"2020-10-26T10:21:54+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(51, ['2015-03-30', '6:55 AM', '51', '68', '1', '9506.21']), (99, ['2015-03-30', '7:39 PM', '99', '86', '5', '4107.59']), (79, ['2015-03-30', '11:57 AM', '79', '58', '7', '2987.22']), (51, ['2015-03-30', '12:46 AM', '51', '50', '6', '7501.89']), (86, ['2015-03-30', '11:39 AM', '86', '24', '5', '8370.2'])]\n"}]},"apps":[],"jobName":"paragraph_1603438526455_-162200503","id":"20201023-163526_346777133","dateCreated":"2020-10-23T16:35:26+0900","dateStarted":"2020-10-26T10:21:54+0900","dateFinished":"2020-10-26T10:21:55+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:704"},{"text":"%pyspark\n\n# 사은품 거래내역 생성\nnew_trans = [['2015-03-30', '11:59 PM', '53', '4', '1', '0']]","user":"anonymous","dateUpdated":"2020-10-26T11:13:26+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1603438526280_1638024427","id":"20201023-163526_263927957","dateCreated":"2020-10-23T16:35:26+0900","dateStarted":"2020-10-26T11:13:26+0900","dateFinished":"2020-10-26T11:13:26+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:705"},{"text":"%pyspark\n\ntransactions3.take(5)","user":"anonymous","dateUpdated":"2020-10-26T10:21:55+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(51, ['2015-03-30', '6:55 AM', '51', '68', '1', '9506.21']), (99, ['2015-03-30', '7:39 PM', '99', '86', '5', '4107.59']), (79, ['2015-03-30', '11:57 AM', '79', '58', '7', '2987.22']), (51, ['2015-03-30', '12:46 AM', '51', '50', '6', '7501.89']), (86, ['2015-03-30', '11:39 AM', '86', '24', '5', '8370.2'])]\n"}]},"apps":[],"jobName":"paragraph_1603441172292_1342649895","id":"20201023-171932_2056643578","dateCreated":"2020-10-23T17:19:32+0900","dateStarted":"2020-10-26T10:21:55+0900","dateFinished":"2020-10-26T10:21:56+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:706"},{"text":"%pyspark\n\n# 최다 거래 고객의 거래 내역 조회\n\ntransactions3.filter( lambda t: t[0] == cid ).collect()    #cid는 위에 올라가면 뽑아낸 key값이 있다.","user":"anonymous","dateUpdated":"2020-10-26T10:21:56+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(53, ['2015-03-30', '6:18 AM', '53', '42', '5', '2197.85']), (53, ['2015-03-30', '4:42 AM', '53', '44', '6', '9182.08']), (53, ['2015-03-30', '2:51 AM', '53', '59', '5', '3154.43']), (53, ['2015-03-30', '5:57 PM', '53', '31', '5', '6649.27']), (53, ['2015-03-30', '6:11 AM', '53', '33', '10', '2353.72']), (53, ['2015-03-30', '9:46 PM', '53', '93', '1', '2889.03']), (53, ['2015-03-30', '4:15 PM', '53', '72', '7', '9157.55']), (53, ['2015-03-30', '2:42 PM', '53', '94', '1', '921.65']), (53, ['2015-03-30', '8:30 AM', '53', '38', '5', '4000.92']), (53, ['2015-03-30', '6:06 AM', '53', '12', '6', '2174.02']), (53, ['2015-03-30', '3:44 AM', '53', '47', '1', '7556.32']), (53, ['2015-03-30', '10:25 AM', '53', '30', '2', '5107.0']), (53, ['2015-03-30', '1:48 AM', '53', '58', '4', '718.93']), (53, ['2015-03-30', '9:31 AM', '53', '18', '4', '8214.79']), (53, ['2015-03-30', '9:04 AM', '53', '68', '4', '9246.59']), (53, ['2015-03-30', '1:51 AM', '53', '40', '1', '4095.5']), (53, ['2015-03-30', '1:53 PM', '53', '85', '9', '1630.24']), (53, ['2015-03-30', '6:51 PM', '53', '100', '1', '1694.52']), (53, ['2015-03-30', '7:39 PM', '53', '100', '8', '7885.35'])]\n"}]},"apps":[],"jobName":"paragraph_1603440790414_-1472509103","id":"20201023-171310_780351354","dateCreated":"2020-10-23T17:13:10+0900","dateStarted":"2020-10-26T10:21:56+0900","dateFinished":"2020-10-26T10:21:57+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:707"},{"text":"%pyspark\n\n# 최다 거래 고객의 거래 내역 조회 2\n\ntransactions3.lookup(cid)\n","user":"anonymous","dateUpdated":"2020-10-26T10:21:57+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[['2015-03-30', '6:18 AM', '53', '42', '5', '2197.85'], ['2015-03-30', '4:42 AM', '53', '44', '6', '9182.08'], ['2015-03-30', '2:51 AM', '53', '59', '5', '3154.43'], ['2015-03-30', '5:57 PM', '53', '31', '5', '6649.27'], ['2015-03-30', '6:11 AM', '53', '33', '10', '2353.72'], ['2015-03-30', '9:46 PM', '53', '93', '1', '2889.03'], ['2015-03-30', '4:15 PM', '53', '72', '7', '9157.55'], ['2015-03-30', '2:42 PM', '53', '94', '1', '921.65'], ['2015-03-30', '8:30 AM', '53', '38', '5', '4000.92'], ['2015-03-30', '6:06 AM', '53', '12', '6', '2174.02'], ['2015-03-30', '3:44 AM', '53', '47', '1', '7556.32'], ['2015-03-30', '10:25 AM', '53', '30', '2', '5107.0'], ['2015-03-30', '1:48 AM', '53', '58', '4', '718.93'], ['2015-03-30', '9:31 AM', '53', '18', '4', '8214.79'], ['2015-03-30', '9:04 AM', '53', '68', '4', '9246.59'], ['2015-03-30', '1:51 AM', '53', '40', '1', '4095.5'], ['2015-03-30', '1:53 PM', '53', '85', '9', '1630.24'], ['2015-03-30', '6:51 PM', '53', '100', '1', '1694.52'], ['2015-03-30', '7:39 PM', '53', '100', '8', '7885.35']]\n"}]},"apps":[],"jobName":"paragraph_1603440795310_171311673","id":"20201023-171315_537120786","dateCreated":"2020-10-23T17:13:15+0900","dateStarted":"2020-10-26T10:21:57+0900","dateFinished":"2020-10-26T10:21:57+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:708"},{"text":"%pyspark\n\n# 최다 거래 고객의 거래 내역 조회 3\nfor t in transactions3.lookup(cid):\n    print(' '.join(t))     # t 리스트를 해체해서 각 요소를 공백(' ')을 사이에 두고 결합\n    # print(','.join(t))","user":"anonymous","dateUpdated":"2020-10-26T10:21:57+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"2015-03-30 6:18 AM 53 42 5 2197.85\n2015-03-30 4:42 AM 53 44 6 9182.08\n2015-03-30 2:51 AM 53 59 5 3154.43\n2015-03-30 5:57 PM 53 31 5 6649.27\n2015-03-30 6:11 AM 53 33 10 2353.72\n2015-03-30 9:46 PM 53 93 1 2889.03\n2015-03-30 4:15 PM 53 72 7 9157.55\n2015-03-30 2:42 PM 53 94 1 921.65\n2015-03-30 8:30 AM 53 38 5 4000.92\n2015-03-30 6:06 AM 53 12 6 2174.02\n2015-03-30 3:44 AM 53 47 1 7556.32\n2015-03-30 10:25 AM 53 30 2 5107.0\n2015-03-30 1:48 AM 53 58 4 718.93\n2015-03-30 9:31 AM 53 18 4 8214.79\n2015-03-30 9:04 AM 53 68 4 9246.59\n2015-03-30 1:51 AM 53 40 1 4095.5\n2015-03-30 1:53 PM 53 85 9 1630.24\n2015-03-30 6:51 PM 53 100 1 1694.52\n2015-03-30 7:39 PM 53 100 8 7885.35\n"}]},"apps":[],"jobName":"paragraph_1603441435794_1779077213","id":"20201023-172355_2077452663","dateCreated":"2020-10-23T17:23:55+0900","dateStarted":"2020-10-26T10:21:57+0900","dateFinished":"2020-10-26T10:21:58+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:709"},{"title":"## 바비 쇼핑몰 놀이 세트를 두 개 이상 구매하면 청구 금액을 5% 할인 ## 바비 쇼핑몰 놀이 세트 ID : 25","text":"%pyspark\n## 바비 쇼핑몰 놀이 세트를 두 개 이상 구매하면 청구 금액을 5% 할인\n## 바비 쇼핑몰 놀이 세트 ID : 25","user":"anonymous","dateUpdated":"2020-10-26T10:21:58+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1603441435507_-612558399","id":"20201023-172355_461907663","dateCreated":"2020-10-23T17:23:55+0900","dateStarted":"2020-10-26T10:21:58+0900","dateFinished":"2020-10-26T10:21:58+0900","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:710"},{"text":"%pyspark\n\n# 문자열이기 때문에 숫자로 바꿔줘야함.\n\n# transactions3.filter( lambda t: t[1][3] == '25' and t[1][4] >= '2') 또는  transactions3.filter( lambda t: int(t[1][3]) == 25 and int(t[1][4]) >= 2)\ntransactions3.filter( lambda t: int(t[1][3]) == 25 and int(t[1][4]) >= 2).collect()","user":"anonymous","dateUpdated":"2020-10-26T10:21:58+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":90,"optionOpen":false}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(17, ['2015-03-30', '6:26 PM', '17', '25', '6', '7193.11']), (93, ['2015-03-30', '7:27 AM', '93', '25', '7', '2749.15']), (68, ['2015-03-30', '1:07 AM', '68', '25', '9', '8391.61']), (59, ['2015-03-30', '1:23 AM', '59', '25', '5', '5296.69']), (42, ['2015-03-30', '9:45 AM', '42', '25', '10', '1363.97']), (77, ['2015-03-30', '10:40 PM', '77', '25', '3', '3345.81']), (22, ['2015-03-30', '12:53 PM', '22', '25', '9', '6996.42']), (32, ['2015-03-30', '12:44 AM', '32', '25', '8', '8849.5']), (75, ['2015-03-30', '5:30 PM', '75', '25', '10', '3557.01'])]\n"}]},"apps":[],"jobName":"paragraph_1603441434917_556872697","id":"20201023-172354_1737007927","dateCreated":"2020-10-23T17:23:54+0900","dateStarted":"2020-10-26T10:21:58+0900","dateFinished":"2020-10-26T10:21:58+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:711"},{"text":"%pyspark\n\ndef discount1(t):\n    if int(t[1][3]) == 25 and int(t[1][4]) >= 2:\n        t[1][5] = str(float(t[1][5]) * 0.95)    # 금액의 5% 할인\n        \n    return t\n    \ntransactions3_1=transactions3.map(discount1)\n\ntransactions3_1.filter(lambda t: int(t[1][3]) == 25 and int(t[1][4]) >= 2).take(5)","user":"anonymous","dateUpdated":"2020-10-26T10:21:58+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(17, ['2015-03-30', '6:26 PM', '17', '25', '6', '6833.454499999999']), (93, ['2015-03-30', '7:27 AM', '93', '25', '7', '2611.6925']), (68, ['2015-03-30', '1:07 AM', '68', '25', '9', '7972.029500000001']), (59, ['2015-03-30', '1:23 AM', '59', '25', '5', '5031.8555']), (42, ['2015-03-30', '9:45 AM', '42', '25', '10', '1295.7715'])]\n"}]},"apps":[],"jobName":"paragraph_1603442491513_-1833833984","id":"20201023-174131_1171259671","dateCreated":"2020-10-23T17:41:31+0900","dateStarted":"2020-10-26T10:21:58+0900","dateFinished":"2020-10-26T10:21:59+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:712"},{"text":"%pyspark\n\ndef discount2(t):\n    if int(t[3]) == 25 and int(t[4]) >= 2:\n        t[5] = str(float(t[5]) * 0.95)    # 금액의 5% 할인\n        \n    return t\n    \ntransactions3_2=transactions3.mapValues(discount2)\n\ntransactions3_2.filter(lambda t: int(t[1][3]) == 25 and int(t[1][4]) >= 2).take(5)","user":"anonymous","dateUpdated":"2020-10-26T10:21:59+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(17, ['2015-03-30', '6:26 PM', '17', '25', '6', '6833.454499999999']), (93, ['2015-03-30', '7:27 AM', '93', '25', '7', '2611.6925']), (68, ['2015-03-30', '1:07 AM', '68', '25', '9', '7972.029500000001']), (59, ['2015-03-30', '1:23 AM', '59', '25', '5', '5031.8555']), (42, ['2015-03-30', '9:45 AM', '42', '25', '10', '1295.7715'])]\n"}]},"apps":[],"jobName":"paragraph_1603442490746_-2043008124","id":"20201023-174130_883146965","dateCreated":"2020-10-23T17:41:30+0900","dateStarted":"2020-10-26T10:21:59+0900","dateFinished":"2020-10-26T10:21:59+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:713"},{"text":"%pyspark\n\n# 25번 제품을 2개 이상 구매한 거래에 대해 5% 청구할인 처리 \ntransactions3=transactions3.mapValues(discount2)\n\ntransactions3.filter(lambda t: int(t[1][3]) == 25 and int(t[1][4]) >= 2).take(5)","user":"anonymous","dateUpdated":"2020-10-26T10:21:59+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(17, ['2015-03-30', '6:26 PM', '17', '25', '6', '6833.454499999999']), (93, ['2015-03-30', '7:27 AM', '93', '25', '7', '2611.6925']), (68, ['2015-03-30', '1:07 AM', '68', '25', '9', '7972.029500000001']), (59, ['2015-03-30', '1:23 AM', '59', '25', '5', '5031.8555']), (42, ['2015-03-30', '9:45 AM', '42', '25', '10', '1295.7715'])]\n"}]},"apps":[],"jobName":"paragraph_1603443745065_1255663687","id":"20201023-180225_510183753","dateCreated":"2020-10-23T18:02:25+0900","dateStarted":"2020-10-26T10:21:59+0900","dateFinished":"2020-10-26T10:22:00+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:714"},{"text":"%pyspark\n\n# 사전을 다섯 권 이상 구매한 고객에게 사은품으로 칫솔 보내기\n# 사전 ID : 81 , 사은품 칫솔 ID : 70\n# 조건에 맞는 81번 찾기->70번을 새로 만들기 ->원본에 추가    (filter로 뽑아내고, )","user":"anonymous","dateUpdated":"2020-10-26T10:22:00+0900","config":{"colWidth":12,"fontSize":11,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1603443947482_-126848017","id":"20201023-180547_1642533265","dateCreated":"2020-10-23T18:05:47+0900","dateStarted":"2020-10-26T10:22:00+0900","dateFinished":"2020-10-26T10:22:00+0900","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:715"},{"text":"%pyspark\n\nimport copy\n\ndef add_gift(t):\n    if int(t[3]) == 81 and int(t[4]) >= 5:\n        cloned = copy.copy(t)\n        cloned[3] = \"70\"     #제품번호\n        cloned[4] = \"1\"      # 개수\n        cloned[5] = \"0.00\"    #가격\n        \n        return [t, cloned]\n    else:\n        return [t]","user":"anonymous","dateUpdated":"2020-10-26T10:22:00+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1603440789321_196235970","id":"20201023-171309_79103035","dateCreated":"2020-10-23T17:13:09+0900","dateStarted":"2020-10-26T10:22:00+0900","dateFinished":"2020-10-26T10:22:00+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:716"},{"text":"%pyspark\n\n# transactions3.take(2)\ntransactions3=transactions3.flatMapValues(add_gift)\n# transactions3.flatMapValues(add_gift)","user":"anonymous","dateUpdated":"2020-10-26T10:22:00+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1603438525505_345481145","id":"20201023-163525_2073995049","dateCreated":"2020-10-23T16:35:25+0900","dateStarted":"2020-10-26T10:22:00+0900","dateFinished":"2020-10-26T10:22:00+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:717"},{"text":"%pyspark\n\ntransactions3.filter(lambda t: t[0]==85 and t[1][3] =='70' ) .take(5)\n","user":"anonymous","dateUpdated":"2020-10-26T10:22:00+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(85, ['2015-03-30', '1:55 PM', '85', '70', '1', '0.00'])]\n"}]},"apps":[],"jobName":"paragraph_1603674939944_-609651807","id":"20201026-101539_1219380283","dateCreated":"2020-10-26T10:15:39+0900","dateStarted":"2020-10-26T10:22:00+0900","dateFinished":"2020-10-26T10:22:01+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:718"},{"text":"%pyspark\n\n# 구매액이 가장 많은 고객 찾기   (고객별 금액합)","user":"anonymous","dateUpdated":"2020-10-26T10:26:22+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1603674939777_1906109570","id":"20201026-101539_1775234137","dateCreated":"2020-10-26T10:15:39+0900","dateStarted":"2020-10-26T10:25:04+0900","dateFinished":"2020-10-26T10:25:04+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:719"},{"text":"%pyspark\n\namounts = transactions3.mapValues( lambda t: float(t[5]) )    # (고객번호, 금액) 만 뽑음.","user":"anonymous","dateUpdated":"2020-10-26T10:29:53+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1603674939573_-253726686","id":"20201026-101539_725169938","dateCreated":"2020-10-26T10:15:39+0900","dateStarted":"2020-10-26T10:29:08+0900","dateFinished":"2020-10-26T10:29:08+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:720"},{"text":"%pyspark\n\namounts.take(5)","user":"anonymous","dateUpdated":"2020-10-26T10:29:20+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(51, 9506.21), (99, 4107.59), (79, 2987.22), (51, 7501.89), (86, 8370.2)]\n"}]},"apps":[],"jobName":"paragraph_1603674939203_-2006026614","id":"20201026-101539_955513810","dateCreated":"2020-10-26T10:15:39+0900","dateStarted":"2020-10-26T10:29:20+0900","dateFinished":"2020-10-26T10:29:21+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:721"},{"text":"%pyspark\n\ntotals = amounts.foldByKey(0, lambda amt1, amt2: amt1 + amt2)   # 0: 기본값","user":"anonymous","dateUpdated":"2020-10-26T11:58:33+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1603675965247_174438309","id":"20201026-103245_1322783585","dateCreated":"2020-10-26T10:32:45+0900","dateStarted":"2020-10-26T10:35:12+0900","dateFinished":"2020-10-26T10:35:12+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:722"},{"text":"%pyspark\n\ntotals.sortBy( lambda total: -total[1]).take(5)","user":"anonymous","dateUpdated":"2020-10-26T10:36:54+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(76, 100049.0), (53, 88829.76), (56, 85906.94), (51, 83312.12), (31, 83202.61)]\n"}]},"apps":[],"jobName":"paragraph_1603675964825_1646166228","id":"20201026-103244_503016399","dateCreated":"2020-10-26T10:32:44+0900","dateStarted":"2020-10-26T10:36:54+0900","dateFinished":"2020-10-26T10:36:55+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:723"},{"text":"%pyspark\n\n#최대 구매 고객에게 63번 제품을 사은품으로 증정(사은품 리스트에 추가)\nnew_trans.append(['2015-03-30', \"11:59 PM\", \"76\", \"63\", \"1\", \"0.00\"]) ","user":"anonymous","dateUpdated":"2020-10-26T11:15:34+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1603675964566_-1949481581","id":"20201026-103244_1089262411","dateCreated":"2020-10-26T10:32:44+0900","dateStarted":"2020-10-26T11:13:45+0900","dateFinished":"2020-10-26T11:13:45+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:724"},{"text":"%pyspark\n\nnew_trans","user":"anonymous","dateUpdated":"2020-10-26T11:14:11+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[['2015-03-30', '11:59 PM', '53', '4', '1', '0'], ['2015-03-30', '11:59 PM', '76', '63', '1', '0.00']]\n"}]},"apps":[],"jobName":"paragraph_1603675964356_-832636822","id":"20201026-103244_2004361734","dateCreated":"2020-10-26T10:32:44+0900","dateStarted":"2020-10-26T11:13:52+0900","dateFinished":"2020-10-26T11:13:52+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:725"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2020-10-26T11:20:45+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1603678845552_-1745298469","id":"20201026-112045_1397697750","dateCreated":"2020-10-26T11:20:45+0900","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:726"},{"text":"%pyspark\n#사은품 리스트를 거래 내역에 추가 (결합)","user":"anonymous","dateUpdated":"2020-10-26T11:20:44+0900","config":{"colWidth":12,"fontSize":14,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1603675964104_-48185081","id":"20201026-103244_1785175482","dateCreated":"2020-10-26T10:32:44+0900","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:727"},{"text":"%pyspark\n\n# python list -> RDD : parallelize\nprint(sc.parallelize(new_trans))\n\nnew_trans_rdd = sc.parallelize(new_trans).map(lambda t: (int(t[2]), t))\n\ntransactions3=transactions3.union(new_trans_rdd)","user":"anonymous","dateUpdated":"2020-10-26T11:25:05+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ParallelCollectionRDD[110] at parallelize at PythonRDD.scala:195\n"}]},"apps":[],"jobName":"paragraph_1603675963895_-1167878472","id":"20201026-103243_1153074519","dateCreated":"2020-10-26T10:32:43+0900","dateStarted":"2020-10-26T11:25:05+0900","dateFinished":"2020-10-26T11:25:05+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:728"},{"text":"%pyspark\n\n# hdfs에 저장\ntransactions3.map(lambda t: '#'.join(t[1])).saveAsTextFile('data-files/transaction-by-customer')   \n\n#file:// : 로컬파일 시스템에 저장\ntransactions3.map(lambda t: '#'.join(t[1])).saveAsTextFile('file:///home/hadoopdev/data-files/transaction-by-customer')   ","user":"anonymous","dateUpdated":"2020-10-26T11:34:01+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1603675963551_1469334384","id":"20201026-103243_1684145540","dateCreated":"2020-10-26T10:32:43+0900","dateStarted":"2020-10-26T11:32:15+0900","dateFinished":"2020-10-26T11:32:26+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:729"},{"text":"%pyspark\n\n#### 두개 이상의 파일의 데이터 합쳐서 작업. #####\n\n# 전일 판매상품 이름과 상품별 매출액 합계","user":"anonymous","dateUpdated":"2020-10-26T11:45:17+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1603675962762_-2097893298","id":"20201026-103242_250694960","dateCreated":"2020-10-26T10:32:42+0900","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:730"},{"text":"%pyspark\n\nprint(transactions2.take(2))   #원본데이터 -> 리스트로 변환된 상태.\n\ntransactions4=transactions2.map(lambda t: (int(t[3]), t))     # (key : product , value )","user":"anonymous","dateUpdated":"2020-10-26T11:50:02+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[['2015-03-30', '6:55 AM', '51', '68', '1', '9506.21'], ['2015-03-30', '7:39 PM', '99', '86', '5', '4107.59']]\n"}]},"apps":[],"jobName":"paragraph_1603680204633_-1168644541","id":"20201026-114324_1813794986","dateCreated":"2020-10-26T11:43:24+0900","dateStarted":"2020-10-26T11:50:02+0900","dateFinished":"2020-10-26T11:50:02+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:731"},{"text":"%pyspark\n\ntransactions4.take(3)","user":"anonymous","dateUpdated":"2020-10-26T11:50:17+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(68, ['2015-03-30', '6:55 AM', '51', '68', '1', '9506.21']), (86, ['2015-03-30', '7:39 PM', '99', '86', '5', '4107.59']), (58, ['2015-03-30', '11:57 AM', '79', '58', '7', '2987.22'])]\n"}]},"apps":[],"jobName":"paragraph_1603680204049_-2115614798","id":"20201026-114324_701002402","dateCreated":"2020-10-26T11:43:24+0900","dateStarted":"2020-10-26T11:50:17+0900","dateFinished":"2020-10-26T11:50:17+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:732"},{"text":"%pyspark\n#데이터 읽어오는 작업\n\n# products=sc.textFile('data-files/products.txt')\n# products.take(2)\n\nproducts=sc.textFile('data-files/products.txt') \\\n           .map(lambda line: line.split('#')) \\\n           .map(lambda p: (int(p[0]),p))   #(제품번호, 제품정보)\n","user":"anonymous","dateUpdated":"2020-10-26T11:55:12+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1603680203858_-1208818626","id":"20201026-114323_1199800641","dateCreated":"2020-10-26T11:43:23+0900","dateStarted":"2020-10-26T11:55:13+0900","dateFinished":"2020-10-26T11:55:13+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:733"},{"text":"%pyspark\n\nproducts.take(3)","user":"anonymous","dateUpdated":"2020-10-26T11:55:24+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(1, ['1', 'ROBITUSSIN PEAK COLD NIGHTTIME COLD PLUS FLU', '9721.89', '10']), (2, ['2', 'Mattel Little Mommy Doctor Doll', '6060.78', '6']), (3, ['3', 'Cute baby doll, battery', '1808.79', '2'])]\n"}]},"apps":[],"jobName":"paragraph_1603680203693_218242596","id":"20201026-114323_2126954202","dateCreated":"2020-10-26T11:43:23+0900","dateStarted":"2020-10-26T11:55:24+0900","dateFinished":"2020-10-26T11:55:25+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:734"},{"text":"%pyspark\n\n#상품별 매출액 합계\ntotal2=transactions4.mapValues(lambda t: float(t[5]))\\\n             .foldByKey(0, lambda t1, t2 : t1 +t2)\n","user":"anonymous","dateUpdated":"2020-10-26T12:04:50+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1603680203493_1996065998","id":"20201026-114323_1938858517","dateCreated":"2020-10-26T11:43:23+0900","dateStarted":"2020-10-26T12:04:50+0900","dateFinished":"2020-10-26T12:04:50+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:735"},{"text":"%pyspark\n\ntotal2.take(6)              # (제품번호, 제품별 총 판매 금액)","user":"anonymous","dateUpdated":"2020-10-26T12:06:35+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(68, 62133.899999999994), (86, 86316.57), (58, 186539.8), (50, 61318.78), (24, 46973.67), (26, 60695.88)]\n"}]},"apps":[],"jobName":"paragraph_1603680203333_417617120","id":"20201026-114323_1013617461","dateCreated":"2020-10-26T11:43:23+0900","dateStarted":"2020-10-26T12:04:55+0900","dateFinished":"2020-10-26T12:04:55+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:736"},{"text":"%pyspark\n\ntotal2.join(products).take(3)","user":"anonymous","dateUpdated":"2020-10-26T12:05:54+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(68, (62133.899999999994, ['68', 'Niacin', '6295.48', '1'])), (24, (46973.67, ['24', 'LEGO Pirates', '4150.34', '2'])), (48, (50163.71, ['48', 'LG LED TV 42LA6130', '6918.75', '8']))]\n"}]},"apps":[],"jobName":"paragraph_1603680203124_-635153173","id":"20201026-114323_465555564","dateCreated":"2020-10-26T11:43:23+0900","dateStarted":"2020-10-26T12:05:55+0900","dateFinished":"2020-10-26T12:05:59+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:737"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2020-10-26T11:43:23+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1603680203001_422451124","id":"20201026-114323_270033634","dateCreated":"2020-10-26T11:43:23+0900","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:738"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2020-10-26T11:43:22+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1603680202589_1508842400","id":"20201026-114322_1376834308","dateCreated":"2020-10-26T11:43:22+0900","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:739"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2020-10-26T11:43:22+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1603680202435_-667859688","id":"20201026-114322_2029915062","dateCreated":"2020-10-26T11:43:22+0900","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:740"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2020-10-26T11:43:22+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1603680202245_1741273654","id":"20201026-114322_1667606622","dateCreated":"2020-10-26T11:43:22+0900","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:741"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2020-10-26T11:43:22+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1603680202071_-400369381","id":"20201026-114322_284609504","dateCreated":"2020-10-26T11:43:22+0900","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:742"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2020-10-26T11:43:21+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1603680201880_-1089353706","id":"20201026-114321_451468656","dateCreated":"2020-10-26T11:43:21+0900","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:743"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2020-10-26T11:43:21+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1603680201692_68596033","id":"20201026-114321_1980727316","dateCreated":"2020-10-26T11:43:21+0900","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:744"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2020-10-26T11:43:21+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1603680201503_2023901441","id":"20201026-114321_96045819","dateCreated":"2020-10-26T11:43:21+0900","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:745"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2020-10-26T10:32:41+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1603675961679_410817095","id":"20201026-103241_1217026510","dateCreated":"2020-10-26T10:32:41+0900","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:746"},{"text":"%pyspark\n\n","user":"anonymous","dateUpdated":"2020-10-26T10:32:41+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1603674938974_-1555397766","id":"20201026-101538_1346832149","dateCreated":"2020-10-26T10:15:38+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:747"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2020-10-26T10:22:01+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1603674938202_-1487927281","id":"20201026-101538_1868452654","dateCreated":"2020-10-26T10:15:38+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:748"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2020-10-26T10:22:01+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1603674880648_884111610","id":"20201026-101440_1134296993","dateCreated":"2020-10-26T10:14:40+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:749"}],"name":"spark-basic/02.rdd-quickstart","id":"2FQ8W8U4V","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}